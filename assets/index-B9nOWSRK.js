(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=i(o);fetch(o.href,s)}})();function u(){const e=performance.now();let t=e;return{get total(){const i=performance.now();return e-i},get interval(){return performance.now()-t},delta(){const i=performance.now(),n=i-t;return t=i,n}}}const w={VIEWPORT_WIDTH:1280,VIEWPORT_HEIGHT:720,FPS:60,HIDE_CURSOR:!1};class m{canvas;ctx;fps;constructor(t,i={}){const n={...w,...i};if(this.canvas=t,this.ctx=t.getContext("2d"),this.ctx===null)throw new Error("Cannot get 2D context from canvas.");this.fps=n.FPS,this.canvas.width=n.VIEWPORT_WIDTH,this.canvas.height=n.VIEWPORT_HEIGHT,n.HIDE_CURSOR&&(this.canvas.style.cursor="none")}resize(t,i){this.canvas.width=t,this.canvas.height=i}render(t){const i=u();let n=0,o=0;if(!this.ctx)return;const s=()=>{t(this.ctx,{fps:n.toFixed(2),currentFrame:o,viewport:{width:this.canvas.width,height:this.canvas.height}}),requestAnimationFrame(s),o++,i.interval>=1e3&&(n=o/i.delta()*1e3,o=0)};return s()}}class p{position;size;color;visible;constructor(){this.size={width:0,height:0},this.color="black",this.visible=!0,console.log("Entity initialized.")}setSize(t,i){return this.size={width:t,height:i},this}setPosition(t,i){return this.position={x:t,y:i},this}setColor(t){return this.color=t,this}setVisible(t){return this.visible=t,this}draw(t){!this.visible||!this.position||(t.fillStyle=this.color,t.fillRect(this.position.x,this.position.y,this.size.width,this.size.height))}isInBound(t){return!(!this.position||t.x<this.position.x||t.x>=this.position.x+this.size.width||t.y<this.position.y||t.y>=this.position.y+this.size.height)}}function h(e){return new Promise(t=>{const i=new Image;i.onload=()=>{t(i)},i.onerror=()=>{throw new Error(`Image error: ${e}`)},i.src=e})}function g(e=window){const t={x:0,y:0,active:!1};return e.addEventListener("mousemove",i=>{if(i instanceof MouseEvent){const{clientX:n,clientY:o}=i;t.x=n,t.y=o,t.active=!0}}),e.addEventListener("mouseleave",()=>{t.active=!1}),t}const d=document.getElementById("mainframe"),l=g(d),c=await h("./diamond_sword.png"),y=await h("./scream.jpg"),f=new m(d,{VIEWPORT_WIDTH:window.innerWidth,VIEWPORT_HEIGHT:window.innerHeight,FPS:75,HIDE_CURSOR:!0}),r=new p().setColor("green").setSize(300,150).setPosition(600,300);f.render((e,t)=>{const{currentFrame:i,fps:n,viewport:o}=t;e.imageSmoothingEnabled=!1,e.clearRect(0,0,o.width,o.height),e.drawImage(y,130,30),e.beginPath(),e.moveTo(300,550),e.lineTo(900,800),e.lineTo(900,700),e.lineWidth=5,e.strokeStyle="yellow",e.stroke(),e.beginPath(),e.moveTo(300,550),e.lineTo(900,700),e.lineWidth=5,e.strokeStyle="blue",e.stroke(),r.draw(e),e.fillStyle="black",e.fillRect(0,0,135,24),e.fillStyle="yellow",e.font="24px Consolas, monospace, sans-serif",e.textAlign="left",e.textBaseline="top",e.fillText(`FPS: ${n}`,0,0),e.fillStyle="black",e.fillRect(0,25,122,24),e.fillStyle="yellow",e.font="24px Consolas, monospace, sans-serif",e.textAlign="left",e.textBaseline="top",e.fillText(`Frame: ${i}`,0,25),l.active&&e.drawImage(c,l.x,l.y,c.width*4,c.height*4)});window.addEventListener("resize",()=>{const{innerWidth:e,innerHeight:t}=window;f.resize(e,t)});window.addEventListener("keydown",e=>{if(e instanceof KeyboardEvent){const{code:t,repeat:i}=e,n=10;if(console.log(t,i),!r.position)return;const o={...r.position};({ArrowUp:()=>o.y+=-1*n,ArrowLeft:()=>o.x+=-1*n,ArrowDown:()=>o.y+=n,ArrowRight:()=>o.x+=n})[t]?.call(null),r.position=o}});window.addEventListener("click",e=>{if(e instanceof MouseEvent&&r.visible&&r.isInBound(l)){const t=Math.random()*255,i=Math.random()*255,n=Math.random()*255;r.setColor(`rgb(${t}, ${i}, ${n})`)}});
