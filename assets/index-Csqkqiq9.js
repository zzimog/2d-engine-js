(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();function w(){const n=performance.now();let t=n;return{get total(){return performance.now()-n},get interval(){return performance.now()-t},delta(){const e=performance.now(),s=e-t;return t=e,s}}}const y={VIEWPORT_WIDTH:1280,VIEWPORT_HEIGHT:720,VSYNC:!1,FPS:60,HIDE_CURSOR:!1};class v{options;canvas;ctx;fps;run;drawFrame;constructor(t,e={}){const s={...y,...e};this.options=s,this.canvas=t;const i=t.getContext("2d");if(i===null)throw new Error("Cannot get 2D context from canvas.");this.ctx=i,this.fps=s.FPS,this.run=!0,this.setup()}setup(){this.canvas.width=this.options.VIEWPORT_WIDTH,this.canvas.height=this.options.VIEWPORT_HEIGHT,this.options.HIDE_CURSOR&&(this.canvas.style.cursor="none"),window.ENGINE=this}resize(t,e){this.canvas.width=t,this.canvas.height=e,this.ctx.imageSmoothingEnabled=!1}render(t){const e=w();let s=0,i=0;this.drawFrame=()=>{this.ctx.imageSmoothingEnabled=!1,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),t({fps:0,currentFrame:0})},this.ctx.imageSmoothingEnabled=!1;const o=()=>{this.run&&(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),t({fps:s.toFixed(2),currentFrame:i})),i++,e.interval>1e3&&(s=i/e.delta()*1e3,i=0),this.options.VSYNC?requestAnimationFrame(o):setTimeout(o,1e3/this.options.FPS)};return o()}}function E(n){for(const[t,e]of Object.entries(n))if(e)return t}class g{engine;position;size;color;constructor(t){this.engine=t,this.size={width:0,height:0},this.position={x:0,y:0},this.color="transparent",console.log("Entity initialized.")}setSize(t,e){return this.size={width:t,height:e??t},this}setPosition(t){return typeof t=="function"&&(t=t(this.position)),this.position={x:Math.floor(t.x),y:Math.floor(t.y)},this}setColor(t){return this.color=t,this}getProjections(t){const{x:e,y:s}=t||this.position,{width:i,height:o}=this.size;return{x1:e,x2:e+i,y1:s,y2:s+o}}draw(){const t=this.engine.ctx;t.fillStyle=this.color,t.fillRect(this.position.x,this.position.y,this.size.width,this.size.height)}willCollide(t,e){const s=this.getProjections(t),i=e.getProjections();return s.x1<i.x2&&s.x2>i.x1&&s.y2>i.y1&&s.y1<i.y2}isColliding(t){return this.willCollide(this.position,t)}relativePosition(t){const e=this.getProjections(),s=t.getProjections();return E({TOP:e.y1>=s.y2,RIGHT:e.x2<=s.x1,BOTTOM:e.y2<=s.y1,LEFT:e.x1>=s.x2})||!1}isInBound(t){return t.x>=this.position.x&&t.x<this.position.x+this.size.width&&t.y>=this.position.y&&t.y<this.position.y+this.size.height}}class C extends g{fps;currentFrame;constructor(t){super(t)}update(t,e){this.fps=t,this.currentFrame=e}draw(){const t=this.engine.ctx,{x:e,y:s}=this.position;t.fillStyle="black",t.fillRect(e,s,135,24),t.fillRect(e,s+25,122,24),t.fillStyle="yellow",t.font="24px Consolas, monospace, sans-serif",t.textAlign="left",t.textBaseline="top",t.fillText(`FPS: ${this.fps}`,e,s),t.fillText(`Frame: ${this.currentFrame}`,e,s+25)}}function c(n,t){return n=Math.ceil(n),t=Math.floor(t),Math.floor(Math.random()*(t-n+1))+n}function I(n,t){return Math.random()<.5?n:t}class p extends g{name;speed_v;speed_h;colliders;constructor(t){super(t);const e=I(-1,1);this.speed_v=e,this.speed_h=e,this.size={width:c(30,80),height:c(30,80)},this.position={x:c(10,window.innerWidth-this.size.width-10),y:c(10,window.innerHeight-this.size.height-10)},this.name="box",this.colliders=[]}setName(t){return this.name=t,this}setColliders(t){return this.colliders=t,this}draw(){const t=this.getProjections();(t.x1<=0||t.x2>=window.innerWidth)&&(this.speed_v*=-1),(t.y1<=0||t.y2>=window.innerHeight)&&(this.speed_h*=-1),this.setPosition(e=>({x:e.x+this.speed_v,y:e.y+this.speed_h}));for(const e of this.colliders){if(this.isColliding(e)){this.setColor("red");break}this.setColor("lime")}super.draw(),this.engine.ctx.fillStyle="black",this.engine.ctx.font="24px Consolas, monospace, sans-serif",this.engine.ctx.textAlign="left",this.engine.ctx.textBaseline="top",this.engine.ctx.fillText(this.name,this.position.x,this.position.y)}}function P(n){return new Promise(t=>{const e=new Image;e.onload=()=>{t(e)},e.onerror=()=>{throw new Error(`Image error: ${n}`)},e.src=n})}function T(n=window){const t={x:0,y:0,active:!1};return n.addEventListener("mousemove",e=>{if(e instanceof MouseEvent){const{clientX:s,clientY:i}=e;t.x=s,t.y=i,t.active=!0}}),n.addEventListener("mouseleave",()=>{t.active=!1}),t}const m=document.getElementById("mainframe"),f=T(m),r=new v(m,{VIEWPORT_WIDTH:window.innerWidth,VIEWPORT_HEIGHT:window.innerHeight,VSYNC:!0,HIDE_CURSOR:!0}),u=await P("./diamond_sword.png"),x=new C(r),h=new p(r).setName("1"),a=new p(r).setName("2"),l=new p(r).setName("3");h.setColliders([a,l]);a.setColliders([h,l]);l.setColliders([h,a]);r.render(n=>{h.draw(),a.draw(),l.draw();const{fps:t,currentFrame:e}=n;x.update(t,e),x.draw(),f.active&&r.ctx.drawImage(u,f.x,f.y,u.width*4,u.height*4)});
