(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();function x(){const s=performance.now();let t=s;return{get total(){return performance.now()-s},get interval(){return performance.now()-t},delta(){const i=performance.now(),n=i-t;return t=i,n}}}const m={VIEWPORT_WIDTH:1280,VIEWPORT_HEIGHT:720,VSYNC:!1,FPS:60,HIDE_CURSOR:!1};class g{options;canvas;ctx;fps;constructor(t,i={}){const n={...m,...i};this.options=n,this.canvas=t;const e=t.getContext("2d");if(e===null)throw new Error("Cannot get 2D context from canvas.");this.ctx=e,this.fps=n.FPS,this.setup()}setup(){this.canvas.width=this.options.VIEWPORT_WIDTH,this.canvas.height=this.options.VIEWPORT_HEIGHT,this.options.HIDE_CURSOR&&(this.canvas.style.cursor="none")}resize(t,i){this.canvas.width=t,this.canvas.height=i,this.ctx.imageSmoothingEnabled=!1}render(t){const i=x();let n=0,e=0;this.ctx.imageSmoothingEnabled=!1;const o=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),t({fps:n.toFixed(2),currentFrame:e}),e++,i.interval>1e3&&(n=e/i.delta()*1e3,e=0),this.options.VSYNC?requestAnimationFrame(o):setTimeout(o,1e3/this.options.FPS)};return o()}}class w{engine;position;size;color;visible;constructor(t){this.engine=t,this.position={x:0,y:0},this.size={width:0,height:0},this.color="transparent",this.visible=!0,console.log("Entity initialized.")}setSize(t,i){return this.size={width:t,height:i??t},this}setPosition(t){return typeof t=="function"&&(t=t(this.position)),this.position={x:Math.floor(t.x),y:Math.floor(t.y)},this}getPosition(){return this.position}setColor(t){return this.color=t,this}setVisible(t){return this.visible=t,this}draw(){const t=this.engine.ctx;!this.visible||!this.position||(t.fillStyle=this.color,t.fillRect(this.position.x,this.position.y,this.size.width,this.size.height))}isInBound(t){return!(!this.position||t.x<this.position.x||t.x>=this.position.x+this.size.width||t.y<this.position.y||t.y>=this.position.y+this.size.height)}}class v extends w{fps;currentFrame;constructor(t){super(t)}update(t,i){this.fps=t,this.currentFrame=i}draw(){const t=this.engine.ctx,{x:i,y:n}=this.position;t.fillStyle="black",t.fillRect(i,n,135,24),t.fillRect(i,n+25,122,24),t.fillStyle="yellow",t.font="24px Consolas, monospace, sans-serif",t.textAlign="left",t.textBaseline="top",t.fillText(`FPS: ${this.fps}`,i,n),t.fillText(`Frame: ${this.currentFrame}`,i,n+25)}}function E(s){return new Promise(t=>{const i=new Image;i.onload=()=>{t(i)},i.onerror=()=>{throw new Error(`Image error: ${s}`)},i.src=s})}function I(s=window){const t={x:0,y:0,active:!1};return s.addEventListener("mousemove",i=>{if(i instanceof MouseEvent){const{clientX:n,clientY:e}=i;t.x=n,t.y=e,t.active=!0}}),s.addEventListener("mouseleave",()=>{t.active=!1}),t}const y=document.getElementById("mainframe"),h=I(y),d=new g(y,{VIEWPORT_WIDTH:window.innerWidth,VIEWPORT_HEIGHT:window.innerHeight,VSYNC:!0,HIDE_CURSOR:!0}),f=await E("./diamond_sword.png"),p=new v(d),r=new w(d).setColor("green").setSize(400).setPosition({x:window.innerWidth/2-200,y:window.innerHeight/2-200}),u=new w(d).setColor("red").setSize(50);d.render(s=>{const{fps:t,currentFrame:i}=s;r.draw(),u.draw(),p.update(t,i),p.draw(),h.active&&d.ctx.drawImage(f,h.x,h.y,f.width*4,f.height*4)});window.addEventListener("resize",()=>{const{innerWidth:s,innerHeight:t}=window;d.resize(s,t)});window.addEventListener("keydown",s=>{if(s instanceof KeyboardEvent){const{code:t,repeat:i}=s,n=10;if(console.log(t,i),!r.position)return;const e={...r.position};({ArrowUp:()=>e.y+=-1*n,ArrowLeft:()=>e.x+=-1*n,ArrowDown:()=>e.y+=n,ArrowRight:()=>e.x+=n})[t]?.call(null),r.position=e}});window.addEventListener("click",s=>{if(s instanceof MouseEvent&&r.visible&&r.isInBound(h)){const t=Math.random()*255,i=Math.random()*255,n=Math.random()*255;r.setColor(`rgb(${t}, ${i}, ${n})`)}});window.addEventListener("mousemove",s=>{if(s instanceof MouseEvent){let t=function(e,o){return e.x1<o.x2&&e.x2>o.x1},i=function(e,o){return e.y2>o.y1&&e.y1<o.y2};const{size:n}=u;u.setPosition(e=>{const o={...e},c={x:h.x-n.width/2,y:h.y-n.height/2},l={x1:c.x,x2:c.x+n.width,y1:c.y,y2:c.y+n.height,...n},a={x1:r.position.x,x2:r.position.x+r.size.width,y1:r.position.y,y2:r.position.y+r.size.height,...r.size};return t(l,a)&&i(l,a)&&(o.x+l.width<=a.x1&&(c.x=a.x1-l.width),o.x>=a.x2&&(c.x=a.x2),o.y+l.height<=a.y1&&(c.y=a.y1-l.height),o.y>=a.y2&&(c.y=a.y2)),c})}});
